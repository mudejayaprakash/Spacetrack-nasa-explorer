<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="View all space observation activities">
    <title>View Activities - SpaceTrack</title>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <!-- Shared Stylesheet -->
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body>
    <!-- Navigation -->
    <header class="site-header">
        <nav class="nav">
            <a class="logo" href="../index.html">
                <i class="fa-solid fa-rocket"></i>
                <span>SpaceTrack</span>
            </a>

            <button class="mobile-menu-btn" aria-label="Open menu">
                <i class="fa-solid fa-bars"></i>
            </button>

            <ul class="nav-links">
                <li><a href="../index.html"><i class="fa-solid fa-home"></i> Home</a></li>
                <li><a href="../data-visualization.html"><i class="fa-solid fa-chart-column"></i> Data Dashboard</a></li>
                <li><a href="../about.html"><i class="fa-solid fa-users"></i> About Us</a></li>
                <li class="crud">
                    <button class="crud-toggle" aria-haspopup="true" aria-expanded="false">
                        CRUD <i class="fa-solid fa-caret-down"></i>
                    </button>
                    <ul class="crud-menu">
                        <li><a href="./create.html"><i class="fa-solid fa-plus"></i> Create</a></li>
                        <li><a href="./read.html"><i class="fa-solid fa-eye"></i> Read</a></li>
                        <li><a href="./update.html"><i class="fa-solid fa-pen"></i> Update</a></li>
                        <li><a href="./delete.html"><i class="fa-solid fa-trash"></i> Delete</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Breadcrumbs -->
            <div class="breadcrumbs">
                <a href="../index.html">Home</a> / Activities
            </div>

            <!-- Page Content -->
            <div class="card">
                <h1 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                    <i class="fa-solid fa-eye" style="color: var(--info);"></i>
                    All Space Activities
                </h1>
                
                <p class="muted" style="margin-bottom: 1.5rem;">
                    This demonstrates the <strong>Read</strong> operation with a searchable list of dummy space observation activities. In the final MVC application, this data will be fetched from the database via API calls.
                </p>

                <div class="info-box">
                    <p style="margin: 0;">
                        <i class="fa-solid fa-circle-info"></i>
                        <strong>Demo Mode:</strong> Displaying simulated data. Use the search box to filter activities by ID, type, mission, or title. Click Update or Delete buttons to modify records.
                    </p>
                </div>

                <!-- Toolbar -->
                <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: center; margin-top: 1.5rem; margin-bottom: 1.5rem;">
                    <div style="flex: 1; min-width: 250px;">
                        <label for="searchInput" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">
                            <i class="fa-solid fa-magnifying-glass"></i> Search Activities
                        </label>
                        <input 
                            type="text" 
                            id="searchInput" 
                            class="input" 
                            placeholder="Search by ID, mission, type, or title..."
                            style="width: 100%;">
                    </div>
                    <div style="display: flex; gap: 0.75rem; align-items: flex-end;">
                        <a href="./create.html" class="btn btn-success">
                            <i class="fa-solid fa-plus"></i> New Activity
                        </a>
                        <button id="clearSearch" class="btn btn-outline">
                            <i class="fa-solid fa-rotate-left"></i> Clear
                        </button>
                    </div>
                </div>

                <!-- Results Info -->
                <div id="resultsInfo" style="margin-bottom: 1rem; color: var(--text-muted); font-size: 0.95rem;">
                    <i class="fa-solid fa-list"></i> Showing <strong id="resultCount">0</strong> activities
                </div>

                <!-- Table Container -->
                <div id="tableContainer"></div>

                <!-- Table Note -->
                <div class="notice" style="margin-top: 1rem;">
                    <p style="margin: 0;">
                        <i class="fa-solid fa-lightbulb"></i>
                        <strong>Tip:</strong> Use the inline action buttons to <strong>Update</strong> or <strong>Delete</strong> individual activities. In the production version, all changes will be persisted to the database and reflected across all visualizations.
                    </p>
                </div>
            </div>

            <!-- Back to Home Button -->
            <div class="btn-group">
                <a class="btn btn-primary" href="../index.html">
                    <i class="fa-solid fa-home"></i> Back to Home
                </a>
                <a class="btn btn-secondary" href="../data-visualization.html">
                    <i class="fa-solid fa-chart-column"></i> View Dashboard
                </a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4><i class="fa-solid fa-rocket"></i> SpaceTrack</h4>
                <ul>
                    <li>NASA Space Data Explorer</li>
                    <li>Mission Analytics & Visualizations</li>
                    <li>Built for ISM 6225</li>
                    <li>University of South Florida</li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Navigation</h4>
                <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="../data-visualization.html">Data Dashboard</a></li>
                    <li><a href="../about.html">About Us</a></li>
                    <li><a href="./read.html">View Activities</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>CRUD Operations</h4>
                <ul>
                    <li><a href="./create.html">Create Activity</a></li>
                    <li><a href="./read.html">Read Activities</a></li>
                    <li><a href="./update.html">Update Activity</a></li>
                    <li><a href="./delete.html">Delete Activity</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Resources</h4>
                <ul>
                    <li><a href="https://api.nasa.gov/" target="_blank">NASA Open APIs</a></li>
                    <li><a href="https://github.com/mudejayaprakash/Spacetrack-nasa-explorer" target="_blank">GitHub Repository</a></li>
                    <li><a href="https://www.nasa.gov/" target="_blank">NASA Official Site</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2025 SpaceTrack - NASA Space Data Explorer | All rights reserved | ISM 6225 Project
        </div>
    </footer>

    <!-- JavaScript -->
    <script src="../js/main.js"></script>
    <script>
        // State
        let allActivities = [];
        let filteredActivities = [];

        // DOM Elements
        const searchInput = document.getElementById('searchInput');
        const clearBtn = document.getElementById('clearSearch');
        const tableContainer = document.getElementById('tableContainer');
        const resultCount = document.getElementById('resultCount');

        // Load activities on page load
        document.addEventListener('DOMContentLoaded', function() {
            loadActivities();
        });

        // Load all activities from CRUD simulator
        function loadActivities() {
            if (window.CRUD && window.CRUD.listActivities) {
                allActivities = window.CRUD.listActivities();
                filteredActivities = [...allActivities];
                renderTable();
            } else {
                console.error('CRUD simulator not loaded');
            }
        }

        // Filter activities based on search query
        function filterActivities(query) {
            const searchTerm = query.toLowerCase().trim();
            
            if (!searchTerm) {
                filteredActivities = [...allActivities];
            } else {
                filteredActivities = allActivities.filter(activity => {
                    const id = String(activity.id).toLowerCase();
                    const type = activity.type.toLowerCase();
                    const title = activity.title.toLowerCase();
                    const mission = window.CRUD.missionName(activity.missionId).toLowerCase();
                    
                    return id.includes(searchTerm) || 
                           type.includes(searchTerm) || 
                           title.includes(searchTerm) ||
                           mission.includes(searchTerm);
                });
            }
            
            renderTable();
        }

        // Render the activities table
        function renderTable() {
            resultCount.textContent = filteredActivities.length;

            if (filteredActivities.length === 0) {
                tableContainer.innerHTML = `
                    <div class="notice" style="text-align: center; padding: 3rem;">
                        <i class="fa-solid fa-inbox" style="font-size: 3rem; color: var(--text-muted); margin-bottom: 1rem;"></i>
                        <p style="margin: 0; font-size: 1.1rem;">No activities found</p>
                        <p style="margin: 0.5rem 0 0 0; color: var(--text-muted);">
                            ${searchInput.value ? 'Try adjusting your search criteria' : 'Create your first activity to get started'}
                        </p>
                    </div>
                `;
                return;
            }

            let tableHTML = `
                <div class="table-wrapper">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Mission</th>
                                <th>Type</th>
                                <th>Date</th>
                                <th>Title</th>
                                <th class="right">Actions</th>
                            </tr>
                        </thead>
                        <tbody>
            `;

            filteredActivities.forEach(activity => {
                const mission = window.CRUD.missionName(activity.missionId);
                tableHTML += `
                    <tr data-id="${activity.id}">
                        <td><span class="badge">#${activity.id}</span></td>
                        <td>${mission}</td>
                        <td><span style="text-transform: capitalize;">${activity.type}</span></td>
                        <td>${activity.date}</td>
                        <td>${activity.title}</td>
                        <td class="right">
                            <a href="./update.html?id=${activity.id}" class="btn btn-xs btn-warning" title="Update activity">
                                <i class="fa-solid fa-pen"></i> Update
                            </a>
                            <a href="./delete.html?id=${activity.id}" class="btn btn-xs btn-danger" title="Delete activity">
                                <i class="fa-solid fa-trash"></i> Delete
                            </a>
                        </td>
                    </tr>
                `;
            });

            tableHTML += `
                        </tbody>
                    </table>
                </div>
            `;

            tableContainer.innerHTML = tableHTML;
        }

        // Search input handler with debounce
        let searchTimeout;
        searchInput.addEventListener('input', function() {
            clearTimeout(searchTimeout);
            searchTimeout = setTimeout(() => {
                filterActivities(this.value);
            }, 300);
        });

        // Clear search button
        clearBtn.addEventListener('click', function() {
            searchInput.value = '';
            filterActivities('');
            searchInput.focus();
        });

        // Handle Enter key in search
        searchInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                filterActivities(this.value);
            }
        });
    </script>

    <!-- Botpress Chatbot -->
    <script src="https://cdn.botpress.cloud/webchat/v3.3/inject.js" defer></script>
    <script src="https://files.bpcontent.cloud/2025/10/16/14/20251016142442-JV2BQMNJ.js" defer></script>
</body>
</html>