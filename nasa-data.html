<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Live NASA Data - Real-time space data from NASA APIs">
    <title>NASA Live Data - SpaceTrack</title>
    
    <!-- Font Awesome Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    
    <!-- Shared Stylesheet -->
    <link rel="stylesheet" href="./css/styles.css">
</head>
<body>
    <!-- Navigation -->
    <header class="site-header">
        <nav class="nav">
            <a class="logo" href="./index.html">
                <i class="fa-solid fa-rocket"></i>
                <span>SpaceTrack</span>
            </a>

            <button class="mobile-menu-btn" aria-label="Open menu">
                <i class="fa-solid fa-bars"></i>
            </button>

            <ul class="nav-links">
                <li><a href="./index.html"><i class="fa-solid fa-home"></i> Home</a></li>
                <li><a href="./data-visualization.html"><i class="fa-solid fa-chart-column"></i> Data Dashboard</a></li>
                <li><a href="./nasa-data.html" class="active"><i class="fa-solid fa-satellite"></i> NASA Live Data</a></li>
                <li><a href="./about.html"><i class="fa-solid fa-users"></i> About Us</a></li>
                <li class="crud">
                    <button class="crud-toggle" aria-haspopup="true" aria-expanded="false">
                        CRUD <i class="fa-solid fa-caret-down"></i>
                    </button>
                    <ul class="crud-menu">
                        <li><a href="./crud/create.html"><i class="fa-solid fa-plus"></i> Create</a></li>
                        <li><a href="./crud/read.html"><i class="fa-solid fa-eye"></i> Read</a></li>
                        <li><a href="./crud/update.html"><i class="fa-solid fa-pen"></i> Update</a></li>
                        <li><a href="./crud/delete.html"><i class="fa-solid fa-trash"></i> Delete</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </header>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Page Header -->
            <div style="text-align: center; margin-bottom: 3rem;">
                <h1 style="font-size: 2.5rem; margin-bottom: 1rem; background: linear-gradient(135deg, #60a5fa 0%, #a78bfa 100%); background-clip: text; -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                    <i class="fa-solid fa-satellite"></i> NASA Live Data Integration
                </h1>
                <p class="muted" style="font-size: 1.1rem;">
                    Real-time space data from NASA's public APIs
                </p>
            </div>

            <!-- Info Box -->
            <div class="info-box">
                <p style="margin: 0;">
                    <i class="fa-solid fa-circle-info"></i>
                    <strong>Live API Integration:</strong> This page demonstrates real-time integration with NASA APIs. All data is fetched through our secure backend server which manages API keys and rate limiting.
                </p>
            </div>

            <!-- Loading State -->
            <div id="loadingState" style="text-align: center; padding: 3rem;">
                <i class="fa-solid fa-spinner fa-spin" style="font-size: 3rem; color: var(--primary);"></i>
                <p style="margin-top: 1rem; color: var(--text-muted);">Fetching live data from NASA APIs...</p>
            </div>

            <!-- Astronomy Picture of the Day -->
            <div class="card" id="apodCard" style="display: none;">
                <h2 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                    <i class="fa-solid fa-image" style="color: #3b82f6;"></i>
                    Astronomy Picture of the Day
                </h2>
                <div id="apodContent"></div>
            </div>

            <!-- ISS Current Location -->
            <div class="card" id="issCard" style="display: none;">
                <h2 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                    <i class="fa-solid fa-satellite" style="color: #06b6d4;"></i>
                    International Space Station - Live Location
                </h2>
                <div id="issContent"></div>
            </div>

            <!-- Near Earth Objects -->
            <div class="card" id="neoCard" style="display: none;">
                <h2 style="margin-bottom: 1rem; display: flex; align-items: center; gap: 0.75rem;">
                    <i class="fa-solid fa-meteor" style="color: #f59e0b;"></i>
                    Near Earth Objects (Asteroids Passing Today)
                </h2>
                <div id="neoContent"></div>
            </div>

            <!-- API Information - Compact Version -->
            <div class="card">
                <h2 style="margin-bottom: 1.5rem; display: flex; align-items: center; gap: 0.75rem;">
                    <i class="fa-solid fa-circle-info"></i> NASA API Integration
                </h2>
                
                <p style="margin-bottom: 1.5rem; color: var(--text-muted);">
                    This application integrates with NASA's Open API platform to fetch real-time space data. 
                    All API requests are routed through our backend server for security and rate limit management.
                </p>

                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 1.5rem;">
                    <!-- APOD -->
                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(59, 130, 246, 0.1), rgba(59, 130, 246, 0.05)); border-radius: 0.75rem; border-left: 4px solid #3b82f6;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #3b82f6, #2563eb); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                üñºÔ∏è
                            </div>
                            <div>
                                <h3 style="margin: 0; font-size: 1.1rem; color: #3b82f6;">APOD API</h3>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted);">Astronomy Pictures</p>
                            </div>
                        </div>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--text-muted); line-height: 1.6;">
                            Daily astronomy images from space telescopes and observatories with detailed scientific explanations
                        </p>
                    </div>

                    <!-- NEO -->
                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(245, 158, 11, 0.1), rgba(245, 158, 11, 0.05)); border-radius: 0.75rem; border-left: 4px solid #f59e0b;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #f59e0b, #d97706); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                ‚òÑÔ∏è
                            </div>
                            <div>
                                <h3 style="margin: 0; font-size: 1.1rem; color: #f59e0b;">NEO API</h3>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted);">Asteroid Tracking</p>
                            </div>
                        </div>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--text-muted); line-height: 1.6;">
                            Near-Earth Object tracking system monitoring asteroids passing close to Earth with hazard assessment
                        </p>
                    </div>

                    <!-- ISS -->
                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(6, 182, 212, 0.05)); border-radius: 0.75rem; border-left: 4px solid #06b6d4;">
                        <div style="display: flex; align-items: center; gap: 1rem; margin-bottom: 1rem;">
                            <div style="width: 50px; height: 50px; background: linear-gradient(135deg, #06b6d4, #0891b2); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem;">
                                üõ∞Ô∏è
                            </div>
                            <div>
                                <h3 style="margin: 0; font-size: 1.1rem; color: #06b6d4;">ISS Tracker</h3>
                                <p style="margin: 0; font-size: 0.85rem; color: var(--text-muted);">Real-time Location</p>
                            </div>
                        </div>
                        <p style="margin: 0; font-size: 0.95rem; color: var(--text-muted); line-height: 1.6;">
                            Live position tracking of the International Space Station orbiting Earth at 28,000 km/h
                        </p>
                    </div>
                </div>

                <div style="margin-top: 2rem; padding: 1rem; background: rgba(59, 130, 246, 0.05); border-radius: 0.5rem; border: 1px solid rgba(59, 130, 246, 0.2);">
                    <p style="margin: 0; font-size: 0.95rem; color: var(--text-muted); text-align: center;">
                        <i class="fa-solid fa-link"></i>
                        <strong style="color: var(--text-light);">API Source:</strong> 
                        All data provided by NASA's Open API initiative at 
                        <a href="https://api.nasa.gov/" target="_blank" style="color: #3b82f6; text-decoration: none; font-weight: 600;">api.nasa.gov</a>
                    </p>
                </div>
            </div>

            <!-- Navigation Buttons -->
            <div class="btn-group">
                <a class="btn btn-primary" href="./index.html">
                    <i class="fa-solid fa-home"></i> Back to Home
                </a>
                <a class="btn btn-secondary" href="./data-visualization.html">
                    <i class="fa-solid fa-chart-column"></i> View Dashboard
                </a>
                <a class="btn btn-success" href="./crud/read.html">
                    <i class="fa-solid fa-eye"></i> View Activities
                </a>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="footer-content">
            <div class="footer-section">
                <h4><i class="fa-solid fa-rocket"></i> SpaceTrack</h4>
                <ul>
                    <li>NASA Space Data Explorer</li>
                    <li>Mission Analytics & Visualizations</li>
                    <li>Built for ISM 6225</li>
                    <li>University of South Florida</li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Navigation</h4>
                <ul>
                    <li><a href="./index.html">Home</a></li>
                    <li><a href="./data-visualization.html">Data Dashboard</a></li>
                    <li><a href="./nasa-data.html">NASA Live Data</a></li>
                    <li><a href="./about.html">About Us</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>CRUD Operations</h4>
                <ul>
                    <li><a href="./crud/create.html">Create Activity</a></li>
                    <li><a href="./crud/read.html">Read Activities</a></li>
                    <li><a href="./crud/update.html">Update Activity</a></li>
                    <li><a href="./crud/delete.html">Delete Activity</a></li>
                </ul>
            </div>
            <div class="footer-section">
                <h4>Resources</h4>
                <ul>
                    <li><a href="https://api.nasa.gov/" target="_blank">NASA Open APIs</a></li>
                    <li><a href="https://github.com/mudejayaprakash/Spacetrack-nasa-explorer" target="_blank">GitHub Repository</a></li>
                    <li><a href="https://www.nasa.gov/" target="_blank">NASA Official Site</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            &copy; 2025 SpaceTrack - NASA Space Data Explorer | All rights reserved | ISM 6225 Project
        </div>
    </footer>

    <!-- Botpress Chatbot -->
    <script src="https://cdn.botpress.cloud/webchat/v3.3/inject.js" defer></script>
    <script src="https://files.bpcontent.cloud/2025/10/16/14/20251016142442-JV2BQMNJ.js" defer></script>

    <!-- JavaScript -->
    <script src="./js/config.js"></script>
    <script src="./js/api.js"></script>
    <script src="./js/main.js"></script>
    <script>
        // Load NASA data on page load
        document.addEventListener('DOMContentLoaded', async function() {
            await Promise.all([
                loadAPOD(),
                loadISS(),
                loadNEO()
            ]);
            
            document.getElementById('loadingState').style.display = 'none';
        });

        // 1. Astronomy Picture of the Day
        async function loadAPOD() {
            try {
                console.log('üì° Fetching APOD from NASA...');
                const response = await fetch('http://localhost:3000/api/nasa/apod');
                const result = await response.json();

                if (result.success && result.data) {
                    const apod = result.data;
                    const content = document.getElementById('apodContent');

                    content.innerHTML = `
                        <div style="display: grid; gap: 1.5rem;">
                            <div>
                                <h3 style="color: var(--text-light); margin-bottom: 0.5rem; font-size: 1.3rem;">
                                    ${apod.title}
                                </h3>
                                <p style="color: var(--text-muted); font-size: 0.9rem; margin-bottom: 1rem;">
                                    <i class="fa-solid fa-calendar"></i> ${apod.date}
                                    ${apod.copyright ? ` | <i class="fa-solid fa-camera"></i> ${apod.copyright}` : ''}
                                </p>
                            </div>
                            ${apod.media_type === 'image' ? `
                                <img src="${apod.url}" alt="${apod.title}" 
                                     style="width: 100%; max-height: 500px; object-fit: cover; border-radius: 0.75rem; border: 1px solid var(--border-color); box-shadow: 0 8px 20px rgba(0,0,0,0.3);">
                            ` : apod.media_type === 'video' ? `
                                <iframe src="${apod.url}" 
                                        style="width: 100%; height: 500px; border-radius: 0.75rem; border: 1px solid var(--border-color);"
                                        frameborder="0" allowfullscreen></iframe>
                            ` : ''}
                            <div style="background: rgba(15, 23, 42, 0.6); padding: 1.5rem; border-radius: 0.75rem; border-left: 3px solid #3b82f6;">
                                <h4 style="color: var(--text-light); margin-bottom: 0.75rem; display: flex; align-items: center; gap: 0.5rem;">
                                    <i class="fa-solid fa-book-open"></i> Explanation
                                </h4>
                                <p style="color: var(--text-muted); line-height: 1.8; margin: 0;">
                                    ${apod.explanation}
                                </p>
                            </div>
                            ${apod.hdurl ? `
                                <a href="${apod.hdurl}" target="_blank" class="btn btn-primary" style="justify-content: center;">
                                    <i class="fa-solid fa-external-link"></i> View High Resolution Image
                                </a>
                            ` : ''}
                        </div>
                    `;
                    document.getElementById('apodCard').style.display = 'block';
                    console.log('‚úÖ APOD loaded successfully');
                } else {
                    throw new Error('Failed to load APOD');
                }
            } catch (error) {
                console.error('‚ùå Error loading APOD:', error);
                showError('apodCard', 'apodContent', 'Astronomy Picture of the Day');
            }
        }

        // 2. ISS Current Location
        async function loadISS() {
            try {
                console.log('üì° Fetching ISS location...');
                const response = await fetch('http://localhost:3000/api/nasa/iss-location');
                const result = await response.json();

                if (result.success && result.data) {
                    const iss = result.data.iss_position;
                    const timestamp = new Date(result.data.timestamp * 1000);
                    const content = document.getElementById('issContent');
                    
                    content.innerHTML = `
                        <div style="background: linear-gradient(135deg, rgba(6, 182, 212, 0.1), rgba(6, 182, 212, 0.05)); padding: 2rem; border-radius: 0.75rem; border-left: 4px solid #06b6d4;">
                            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 2rem; margin-bottom: 1.5rem;">
                                <div style="text-align: center;">
                                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 1px;">
                                        <i class="fa-solid fa-location-dot"></i> Latitude
                                    </p>
                                    <p style="font-size: 2rem; font-weight: 700; color: #06b6d4; margin: 0;">
                                        ${parseFloat(iss.latitude).toFixed(4)}¬∞
                                    </p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 1px;">
                                        <i class="fa-solid fa-location-dot"></i> Longitude
                                    </p>
                                    <p style="font-size: 2rem; font-weight: 700; color: #06b6d4; margin: 0;">
                                        ${parseFloat(iss.longitude).toFixed(4)}¬∞
                                    </p>
                                </div>
                                <div style="text-align: center;">
                                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 1px;">
                                        <i class="fa-solid fa-clock"></i> Updated At
                                    </p>
                                    <p style="font-size: 1.25rem; font-weight: 600; color: var(--text-light); margin: 0;">
                                        ${timestamp.toLocaleTimeString()}
                                    </p>
                                </div>
                            </div>
                            <div style="background: rgba(6, 182, 212, 0.1); padding: 1rem; border-radius: 0.5rem;">
                                <p style="margin: 0; color: var(--text-muted); font-size: 0.95rem; text-align: center; line-height: 1.6;">
                                    <i class="fa-solid fa-circle-info"></i>
                                    The ISS orbits Earth at approximately <strong style="color: #06b6d4;">28,000 km/h</strong>, 
                                    completing one orbit every <strong style="color: #06b6d4;">90 minutes</strong> at an altitude of 
                                    <strong style="color: #06b6d4;">~400 km</strong> above Earth's surface.
                                </p>
                            </div>
                        </div>
                    `;
                    document.getElementById('issCard').style.display = 'block';
                    console.log('‚úÖ ISS location loaded successfully');
                } else {
                    throw new Error('Failed to load ISS data');
                }
            } catch (error) {
                console.error('‚ùå Error loading ISS:', error);
                showError('issCard', 'issContent', 'ISS Location');
            }
        }

        // 3. Near Earth Objects
        async function loadNEO() {
            try {
                console.log('üì° Fetching NEO data from NASA...');
                const response = await fetch('http://localhost:3000/api/nasa/neo');
                const result = await response.json();

                if (result.success && result.data) {
                    const today = new Date().toISOString().split('T')[0];
                    const objects = result.data.near_earth_objects[today] || [];
                    const content = document.getElementById('neoContent');

                    if (objects.length === 0) {
                        content.innerHTML = `
                            <div style="text-align: center; padding: 3rem; background: rgba(245, 158, 11, 0.05); border-radius: 0.75rem; border: 1px dashed rgba(245, 158, 11, 0.3);">
                                <i class="fa-solid fa-circle-info" style="font-size: 3rem; color: #f59e0b; margin-bottom: 1rem;"></i>
                                <p style="margin: 0; color: var(--text-muted); font-size: 1.1rem;">
                                    No near-Earth objects detected for today
                                </p>
                                <p style="margin: 0.5rem 0 0 0; color: var(--text-muted); font-size: 0.9rem;">
                                    This is actually good news - our planet is safe today! üåç
                                </p>
                            </div>
                        `;
                    } else {
                        let html = `
                            <div style="background: linear-gradient(135deg, rgba(245, 158, 11, 0.15), rgba(245, 158, 11, 0.05)); padding: 1.5rem; border-radius: 0.75rem; margin-bottom: 1.5rem; border-left: 4px solid #f59e0b;">
                                <p style="margin: 0; color: var(--text-muted); font-size: 1.1rem; text-align: center;">
                                    <i class="fa-solid fa-meteor"></i>
                                    <strong style="color: #f59e0b; font-size: 1.5rem;">${objects.length}</strong> 
                                    asteroid${objects.length > 1 ? 's' : ''} passing near Earth today
                                </p>
                            </div>
                            <div class="table-wrapper">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th><i class="fa-solid fa-signature"></i> Name</th>
                                            <th><i class="fa-solid fa-ruler"></i> Diameter (m)</th>
                                            <th><i class="fa-solid fa-arrows-left-right"></i> Miss Distance (km)</th>
                                            <th><i class="fa-solid fa-gauge-high"></i> Velocity (km/h)</th>
                                            <th><i class="fa-solid fa-triangle-exclamation"></i> Hazardous</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                        `;

                        objects.slice(0, 8).forEach(obj => {
                            const diameter = obj.estimated_diameter.meters;
                            const closeApproach = obj.close_approach_data[0];
                            
                            html += `
                                <tr>
                                    <td style="font-weight: 600; color: var(--text-light);">${obj.name}</td>
                                    <td>${Math.round(diameter.estimated_diameter_min)} - ${Math.round(diameter.estimated_diameter_max)}</td>
                                    <td>${parseInt(closeApproach.miss_distance.kilometers).toLocaleString()}</td>
                                    <td>${parseInt(closeApproach.relative_velocity.kilometers_per_hour).toLocaleString()}</td>
                                    <td>
                                        ${obj.is_potentially_hazardous_asteroid ? 
                                            '<span style="color: #ef4444; font-weight: 600;"><i class="fa-solid fa-triangle-exclamation"></i> Yes</span>' : 
                                            '<span style="color: #10b981; font-weight: 600;"><i class="fa-solid fa-check"></i> No</span>'}
                                    </td>
                                </tr>
                            `;
                        });

                        html += `
                                    </tbody>
                                </table>
                            </div>
                        `;

                        if (objects.length > 8) {
                            html += `
                                <p style="margin-top: 1rem; text-align: center; color: var(--text-muted); font-size: 0.95rem;">
                                    Showing 8 of ${objects.length} objects detected today
                                </p>
                            `;
                        }

                        content.innerHTML = html;
                    }

                    document.getElementById('neoCard').style.display = 'block';
                    console.log('‚úÖ NEO data loaded successfully');
                } else {
                    throw new Error('Failed to load NEO data');
                }
            } catch (error) {
                console.error('‚ùå Error loading NEO:', error);
                showError('neoCard', 'neoContent', 'Near Earth Objects');
            }
        }

        // Show error message
        function showError(cardId, contentId, name) {
            const card = document.getElementById(cardId);
            const content = document.getElementById(contentId);
            
            content.innerHTML = `
                <div class="error" style="text-align: center; padding: 2rem;">
                    <i class="fa-solid fa-triangle-exclamation" style="font-size: 2.5rem; margin-bottom: 1rem;"></i>
                    <p style="margin: 0; font-size: 1.1rem;">Failed to load ${name}</p>
                    <p style="margin: 0.5rem 0 0 0; font-size: 0.9rem;">
                        Please ensure the backend server is running on http://localhost:3000
                    </p>
                </div>
            `;
            card.style.display = 'block';
        }

        console.log('‚úÖ NASA Data page initialized - 3 working APIs');
    </script>
</body>
</html>